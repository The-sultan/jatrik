<?xml version="1.0" encoding="UTF-8"?>
<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:p="http://primefaces.org/ui"
     template="/WEB-INF/templates/default.xhtml">
    <h1>Correo</h1>
    <h:panelGroup id="mailbox">
        <div id="tabs" class="mailbox-form">
            <ul>
                <li><a href="#entradaTab">Bandeja de Entrada 
                        (<h:outputText value="#{correoController.cantidadNoLeidos}" />)</a></li>
                <li><a href="#salidaTab">Bandeja de Salida</a></li>
                <li><a href="#enviarTab">Enviar Correo</a></li>

            </ul>
            <div id="entradaTab">
                <h:form id="entradaForm">
                    <h:panelGroup layout="block" id="entradaPanel" class="resultados">
                        <p:dataTable id="bandejaEntrada" value="#{correoController.bandejaEntrada}" var="correo">
                            <p:column id="Asunto">
                                <f:facet name="header">
                                    <h:outputText value="Asunto" />
                                </f:facet>
                                <f:subview id="mensaje">
                                    <p:accordionPanel id="panel">
                                        <f:facet name="header">
                                            <h:panelGroup>
                                                <h:outputText value="Mensaje"/>
                                            </h:panelGroup>
                                        </f:facet>
                                        <table width="400px" height="300px">
                                            <tr>
                                                <td height="92" valign="top" bgcolor="#FCFCFC" style="font-size: 14px">
                                                    <BR>Enviado por : </BR> 
                                                    <h:outputText value="#{correo.from}" />
                                                    <BR> Fecha : </BR>
                                                    <h:outputText value="#{correo.fecha}" />
                                                    <BR> Asunto	: </BR>
                                                    <h:outputText value="#{correo.asunto}" />
                                                    <p:separator/>
                                                    <font size="2" face="Verdana, Arial, Helvetica, sans-serif"> 
                                                        <h:outputText value="#{correo.mensaje}" />
                                                    </font>
                                                </td>
                                            </tr>
                                        </table>
                                    </p:accordionPanel>
                                    <h:outputLink value="#" id="link">
                                        <h:outputText value="#{correo.asunto}" rendered="#{correo.leido == false}" />
                                        <h:outputText value="#{correo.asunto}" rendered="#{correo.leido == true}" />
                                        <f:param name="idCorreo" id="idCorreo" value="#{correo.id}" />
                                    </h:outputLink>
                                </f:subview>
                            </p:column>
                            <p:column id="From">
                                <f:facet name="header">
                                    <h:outputText styleClass="headerText" value="From" />
                                </f:facet>
                                <h:outputText value="#{correo.from}" rendered="#{correo.leido == false}" />
                                <h:outputText value="#{correo.from}" rendered="#{correo.leido == true}" />
                            </p:column>
                            <p:column id="Fecha">
                                <f:facet name="header">
                                    <h:outputText styleClass="headerText" value="Fecha" />
                                </f:facet>
                                <h:outputText value="#{correo.fecha}" rendered="#{correo.leido == false}" />
                                <h:outputText value="#{correo.fecha}" rendered="#{correo.leido == true}" />
                            </p:column>
                            <p:column id="Marcar">
                                <f:facet name="header">
                                    <h:outputText value="Marcar" />
                                </f:facet>
                                <h:commandLink actionListener="#{correoController.marcarLeido}" id="link">
                                    <h:outputText value="leido" rendered="#{correo.leido == false}" />
                                    <h:outputText value="no leido" rendered="#{correo.leido == true}" />
                                    <f:param name="idCorreo" id="idCorreo" value="#{correo.id}" />
                                </h:commandLink>
                            </p:column>
                        </p:dataTable>
                    </h:panelGroup>
                </h:form>
            </div>
            <div id="salidaTab">
            </div>
            <div id="enviarTab">
                <h:form id="enviarForm">
                    <table>
                        <tr>
                            <td>Para</td>
                            <td>
                                <h:selectOneMenu id="para" binding="#{correoController.usuarioTO}">
                                    <f:selectItems value="#{correoController.usuarios}" />
                                </h:selectOneMenu>
                            </td>
                        </tr>
                        <tr>
                            <td>Asunto</td>
                            <td>
                                <h:inputText id="asuntoMail" value="#{correoController.nuevoCorreo.asunto}" />
                            </td>
                        </tr>
                        <tr>
                            <td>Mensaje</td>
                            <td>
                                <h:inputTextarea id="mensajeMail" rows="10" cols="30" value="#{correoController.nuevoCorreo.mensaje}" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <h:commandButton value="Enviar" actionListener="#{correoController.send}">
                                    <f:ajax render=":mailbox"></f:ajax>
                                </h:commandButton>
                            </td>
                            <td></td>
                        </tr>
                    </table>
                </h:form> 
            </div>
            <script type="text/javascript">
                $("#tabs").tabs();
            </script>
        </div>
    </h:panelGroup>

</div>

