<?xml version="1.0" encoding="UTF-8"?>
<div xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">


<h:form rendered="#{entrenamientoController.error}"> 
<ui:include src="/WEB-INF/templates/error.xhtml" />
</h:form>

<h:form id="formEntr" rendered="#{!entrenamientoController.error}">
	<div id="entrenamiento" class="formEntrenamiento" align="center">

		<div id="jugadoresEntrenar">
			<ui:repeat var="jugador"
				value="#{equipoDatosEntrenamiento.titulares}">
				<div id="jug" class="titular" style="width: 7%">
					<p:panel id="rpnl"
						style="background-color: rgba(255, 255, 255,0);border-color:rgba(0,0,0,0);background-image:none;">
						<ui:insert name="jugador">
							<ui:include src="/tarjeta.xhtml">
								<ui:param name="id" value="#{jugador.id}" />
								<ui:param name="nombre" value="#{jugador.nombre}" />
								<ui:param name="puesto"
									value="#{jugador.puesto.subSequence(0,3)}" />
								<ui:param name="valoracion" value="50" />
								<ui:param name="ataque"
									value="#{jugador.habilidades.get(0).valor}" />
								<ui:param name="defensa"
									value="#{jugador.habilidades.get(1).valor}" />
								<ui:param name="velocidad"
									value="#{jugador.habilidades.get(2).valor}" />
								<ui:param name="tecnica"
									value="#{jugador.habilidades.get(3).valor}" />
								<ui:param name="porteria"
									value="#{jugadorhabilidades.get(4).valor}" />
							</ui:include>
						</ui:insert>
					</p:panel>
				</div>
				<p:draggable for="rpnl" revert="true" />
			</ui:repeat>

		</div>

		<div id="entrenarPorteria" class="divEntenar">

			<div id="innerPorteria"
				style="border-style: solid; border-width: 5px; width: 98%; height: 97%">
				<H1>Porteria</H1>
			</div>



		</div>
		<div id="entrenarDefensa" class="divEntenar">
			<div id="innerDefensa"
				style="border-style: solid; border-width: 5px; width: 98%; height: 97%">
				<H1>Defensa</H1>
			</div>
		</div>
		<div id="entrenarTecnica" class="divEntenar">
			<div id="innerTecnica"
				style="border-style: solid; border-width: 5px; width: 98%; height: 97%">
				<H1>Tecnica</H1>
			</div>
		</div>
		<div id="entrenarVelocidad" class="divEntenar">
			<div id="innerVelocidad"
				style="border-style: solid; border-width: 5px; width: 98%; height: 97%">
				<H1>Velocidad</H1>
			</div>
		</div>
		<div id="entrenarAtque" class="divEntenar">
			<div id="innerAtaque"
				style="border-style: solid; border-width: 5px; width: 98%; height: 97%">
				<H1>Ataque</H1>
			</div>
		</div>
	</div>



	<script>
		var entrenamientoSeleccionado = '';
		var jugadoresSeleccionados = '';
		function handlemouseoverDiv(e) {
			entrenamientoSeleccionado = this.id;

		}
		function handlemouseoutDiv(e) {
			entrenamientoSeleccionado = '';
		}

		function handleClicktDiv(e) {
			alert(jugadoresSeleccionados);
			//Llamar al backend
			if (jugadoresSeleccionados != '') {
				agregarAEntrenamiento([{name:'ids',value:jugadoresSeleccionados},{name:'tipoEntrenamiento',value:entrenamientoSeleccionado}]);
			}
		}

		function handledblclick() {
			this.style.opacity = '0.4';
			if (jugadoresSeleccionados == '') {
				jugadoresSeleccionados = this.id;
			} else {
				jugadoresSeleccionados = jugadoresSeleccionados + "|" + this.id;
			}

		}

		function setHandlers() {
			var cols = document.querySelectorAll('.cardcontainer');
			[].forEach.call(cols, function(col) {

				col.removeEventListener('dblclick', handledblclick, false);
				col.addEventListener('dblclick', handledblclick, false);
			});

			var divs = document.querySelectorAll('.divEntenar');
			[].forEach.call(divs, function(div) {
				div.addEventListener('mouseover', handlemouseoverDiv, false);
				div.addEventListener('mouseout', handlemouseoutDiv, false);
				div.addEventListener('click', handleClicktDiv, false);
			});
		}

		setHandlers();
	</script>




	<p:remoteCommand name="agregarAEntrenamiento"
			action="#{entrenamientoController.agregarAEntrenamiento}" update=""
			ajax="false" />
</h:form>

</div>
